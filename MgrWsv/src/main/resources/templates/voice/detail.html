<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <th:block th:replace="/layout/header.html :: fragment-header"></th:block>
    <style>
        h2 {
            text-align: center;
        }

    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.js"></script>
</head>
<div th:replace="/layout/nav.html :: fragment-nav"></div>
<body>
<div class="container">
    <table class="table">
        <!--    <tr>-->
        <!--      <th>번호</th><td><span th:text="${voicedata.id}"></span></td>-->
        <!--    </tr>-->
        <!--    <tr>-->
        <!--      <th>작성자</th><td><span th:text="${voicedata.getUser().getUserid()}"></span></td>-->
        <!--    </tr>-->
        <tr>
            <th>신고된 번호</th><td><span><b><i th:text="${voicedata.declaration}"></i></b></span></td>
        </tr>
        <tr>
            <th>AI판별값</th><td><span><b><i th:text="${voicedata.disdata}"></i></b></span></td>
        </tr>
        <tr>
            <th>보이스피싱확률</th><td><span><b><i th:text="${voicedata.persent}"></i></b></span></td>
        </tr>
        <tr>
            <th>수정판별값</th><td><span><b><i th:text="${voicedata.admindata}"></i></b></span></td>
        </tr>
        <tr>
            <th>변조여부</th><td><span><b><i th:text="${voicedata.mfcc}"></i></b></span></td>
        </tr>

        <!--    <tr>-->
        <!--      <th>등록일</th><td><span th:text="${board.createdDate}"></span></td>-->
        <!--    </tr>-->
    </table>
    <br>

    <!-- 식별자 변경 : select name -> select id -->
    <!-- button id 변경 : btn-submit -> btn-admindata-submit -->
    <div align="right">
        <form>
            <!-- 서버로부터 넘어온 값 hidden으로 담기 -->
            <input type="hidden" id="id" th:value="${voicedata.getId()}"/>
            <select id="admindata">
                <option value="">판별값선택</option>
                <option value="1">1</option>
                <option value="0">0</option>
            </select>
            <button id="btn-admindata-submit"class="btn btn-primary">제출</button>
        </form>
    </div>

    <div class="container border p-3">
        <div class="form-group">
            <div class="title">파일명 : <span th:text="${voicedata.audio_file}"></span></div>
        </div>
        <div class="form-group">
            <div class="content" th:utext="${voicedata.content}"></div>
        </div>
        <div align="right">
            <button class="btn btn-secondary" onclick="history.back()">돌아가기</button>
        </div>

    </div>
</div>
<!--<script src="/js/board.js"></script>-->
<footer th:replace="/layout/footer.html :: fragment-footer"></footer>
</body>
<script>
    let index = {
        init: function () {
            $("#btn-admindata-submit").on("click", () => {
                this.submit();
            });
        },

        submit: function () {
            const data = {
                id: $("#id").val(),
                admindata: $("#admindata").val()
            };

            const con_check = confirm("제출하시겠습니까?");
            if(con_check === true){
                $.ajax({
                    type: "PUT",
                    url: "/api/voice/" + data.id,
                    data: JSON.stringify(data),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json"
                }).done(function () {
                    alert("제출하였습니다");
                    location.href = "/voice/read/" + data.id;
                }).fail(function (error) {
                    alert(JSON.stringify(error));
                });
            }

        },
    }

    index.init();
</script>
</html>